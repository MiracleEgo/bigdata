# UDP的特点

* 面向非连接
* 不维护连接状态,支持同时向多个客户端传输相同信息
* 数据包报头只有8个字节,额外开销较小
* 吞吐量只受限于数据生成速率,传输速率以及以及机器性能
* 尽最大努力交付,不保证可靠交付,不需要维持复杂的链接状态表
* 面向报文,不对应用程序提交的报文信息进行拆分或者合并

# TCP和UDP的区别

|            | TCP            | UDP        |
| ---------- | -------------- | ---------- |
| 是否连接   | 面向连接       | 面向非连接 |
| 传输可靠性 | 可靠的         | 不可靠的   |
| 应用场合   | 传输大量的数据 | 少量数据   |
| 速度       | 慢             | 快         |

- TCP协议在传送数据段的时候要给段标号；UDP协议不
- TCP协议可靠；UDP协议不可靠
- TCP协议是面向连接；UDP协议采用无连接
- TCP协议负载较高，采用虚电路；UDP采用无连接
- TCP协议的发送方要确认接收方是否收到数据段（3次握手协议）
- TCP协议采用窗口技术和流控制
- TCP基于字节流,太大的数据会被切分,UDP基于数据报

# [UDP实现可靠性传输](https://www.jianshu.com/p/6c73a4585eba)

* UDP不属于连接协议，具有资源消耗少，处理速度快的优点，所以通常音频，视频和普通数据在传送时，使用UDP较多，因为即使丢失少量的包，也不会对接受结果产生较大的影响。

* 传输层无法保证数据的可靠传输，只能通过应用层来实现了。实现的方式可以参照tcp可靠性传输的方式，只是实现不在传输层，实现转移到了应用层。

最简单的方式是在应用层模仿传输层TCP的可靠性传输。下面不考虑拥塞处理，可靠UDP的简单设计。

- 1、添加seq/ack机制，确保数据发送到对端
- 2、添加发送和接收缓冲区，主要是用户超时重传。
- 3、添加超时重传机制。

详细说明：送端发送数据时，生成一个随机seq=x，然后每一片按照数据大小分配seq。数据到达接收端后接收端放入缓存，并发送一个ack=x的包，表示对方已经收到了数据。发送端收到了ack包后，删除缓冲区对应的数据。时间到后，定时任务检查是否需要重传数据。

目前有如下开源程序利用udp实现了可靠的数据传输。分别为***RUDP、RTP、UDT\***。

# [UDP的头部](https://blog.csdn.net/dangzhangjing97/article/details/80991965)

![这里写图片描述](https://i.loli.net/2020/08/18/SHyDfXUhJ98zY6E.png)

`source port`: 源端口号，占16位，2个字节
`dest port`: 目的端口号，占16位，2个字节
`length`: 此字段标记了整个数据报（UDP的首部+UDP数据）的最大长度
`checksum`: 检验和，此字段用处是用来检查收到地数据的对错的
**ps：如果校验和出错，就会直接丢弃**
`Application data`: 数据部分（如果有的话）