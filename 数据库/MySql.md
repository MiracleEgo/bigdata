# MySQL索引

* 索引的原理

对要查询的字段建立索引其实就是**把该字段按照一定的方式排序**；建立的索引只对该字段有用，如果查询的字段改变，那么这个索引也就无效了，比如图书馆的书是按照书名的第一个字母排序的，那么你想要找作者叫张三的就不能用改索引了；**还有就是如果索引太多会降低查询的速度** 

* 优点

如果我们对某一字段增加索引，**查询时就会先去索引列表中一次定位到特定值的行数**，大大减少遍历匹配的行数，所以能明显增加查询的速度。

* 缺点

1、如果每次都需要取到所有表记录，无论如何都必须进行全表扫描了，那么是否加索引也没有意义了。

2、对非唯一的字段，例如“性别”这种大量重复值的字段，增加索引也没有什么意义。

3、对于记录比较少的表，增加索引不会带来速度的优化反而浪费了存储空间，因为索引是需要存储空间的，而且有个致命缺点是对于update/insert/delete的每次执行，字段的索引都必须重新计算更新。所以并不是任何情况下都改建立索引的

## **哪些列适合建立索引**

在**经常需要搜索的列**上，建立索引，增加搜索速度。

在**作为主键的列**上，强制该列的唯一性和组织表中数据的排列结构。

在经常用在连接的列上，这些列主要是**外键**，**可以加快连接速度。** 

在经常需要**根据范围进行搜索的列**上创建索引，因为索引已经排序，所以其指定的范围是连续的。

在经常**需要排列的列上**创建索引，因为索引已经排序，这样可以利用索引的排序，**加快查询的速度。** 

在**经常需要使用WHERE子句**的列上创建索引，**加快条件的判断速度。**

## MySQL里的索引类型

**1. B-Tree索引**

最常见的索引类型，基于B-Tree数据结构。B-Tree的基本思想是，所有值（被索引的列）都是排过序的，每个叶节点到跟节点距离相等。所以B-Tree适合用来查找某一范围内的数据，而且可以直接支持数据排序（ORDER BY）。但是当索引多列时，列的顺序特别重要，需要格外注意。InnoDB和MyISAM都支持B-Tree索引。InnoDB用的是一个变种B+Tree，而MyISAM为了节省空间对索引进行了压缩，从而牺牲了性能。

**2. Hash索引**

基于hash表。所以这种索引只支持精确查找，不支持范围查找，不支持排序。

HASH，BTREE，RTREE

**3. Full-Text**

**4.R-Tree**



# InnoDB

* 若一个主键被定义，该主键则作为密集索引
* 若没有主键被定义，该表的第一个唯一非空索引则作为密集索引
* 若不满足以上条件，innodb内部会生成一个隐藏主键（密集索引）
* 索引和数据存在一块
* 有且只有一个密集索引
* 支持事务

# MyISAM

* 索引和数据分开存储
* 不管是主键索引，唯一键索引还是普通索引都是稀疏索引
* 不支持事务